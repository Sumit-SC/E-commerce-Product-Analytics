# Data Directory

This directory contains all data files for the E-commerce Product Analytics project.

## Directory Structure

```
data/
├── raw/                    # Raw simulated data (source of truth)
│   ├── users.csv           # User profiles and attributes
│   ├── events.csv          # Clickstream events
│   └── orders.csv          # Purchase orders
│
├── processed/              # Cleaned/transformed data (placeholder)
│   └── (empty)             # Reserved for future data cleaning outputs
│
└── powerbi/                # Aggregated exports for Power BI
    ├── funnel_metrics.csv      # Funnel conversion rates
    ├── cohort_retention.csv    # Retention by cohort week
    └── ab_test_summary.csv     # A/B test variant comparison
```

---

## Raw Data (`data/raw/`)

Generated by: `src/data_generator.py`

### users.csv (~120,000 rows)

| Column | Type | Description |
|--------|------|-------------|
| `user_id` | INTEGER | Unique user identifier |
| `signup_date` | DATE | User registration date |
| `device` | VARCHAR | Primary device (mobile/desktop/tablet) |
| `country` | VARCHAR | Country code (US/IN/UK/DE/AU) |
| `loyalty_tier` | VARCHAR | Loyalty tier (bronze/silver/gold/platinum) |

**Distribution:**
- Device: mobile ~65%, desktop ~30%, tablet ~5%
- Loyalty: bronze ~60%, silver ~25%, gold ~12%, platinum ~3%

### events.csv (~1,000,000 rows)

| Column | Type | Description |
|--------|------|-------------|
| `event_id` | VARCHAR (UUID) | Unique event identifier |
| `user_id` | INTEGER | User who triggered the event |
| `session_id` | VARCHAR (UUID) | Session identifier (nullable, ~3% missing) |
| `event_type` | VARCHAR | Event type (visit/product_view/add_to_cart/checkout/purchase) |
| `page` | VARCHAR | Page name (home/search/product/cart/checkout) |
| `product_id` | INTEGER | Product ID (1-2000) |
| `product_category` | VARCHAR | Category (electronics/fashion/home/beauty/sports) |
| `ts` | TIMESTAMP | Event timestamp |
| `source` | VARCHAR | Traffic source (organic/paid/email/referral) |
| `device` | VARCHAR | Device used for this event |
| `ab_test_id` | VARCHAR | A/B test identifier (only for checkout/purchase) |
| `variant` | VARCHAR | Test variant (control/variant) |

**Key characteristics:**
- Funnel progression: visit → product_view → add_to_cart → checkout → purchase
- Cart abandonment: ~70%
- Bot traffic: small % with high event counts, zero purchases
- A/B test: checkout layout experiment on checkout/purchase events

### orders.csv (~45,000 rows)

| Column | Type | Description |
|--------|------|-------------|
| `order_id` | VARCHAR (UUID) | Unique order identifier |
| `user_id` | INTEGER | User who placed the order |
| `product_id` | INTEGER | Product purchased |
| `price` | DOUBLE | Order price (lognormal distribution) |
| `quantity` | INTEGER | Quantity (1-4, skewed toward 1) |
| `discount_amount` | DOUBLE | Discount applied |
| `ts` | TIMESTAMP | Order timestamp |
| `payment_status` | VARCHAR | Payment result (success/failed) |

**Key characteristics:**
- Only successful purchases generate orders
- Payment failures: ~8%
- Price distribution: lognormal (realistic AOV)
- Discounts: mainly for paid traffic and variant users

---

## Power BI Data (`data/powerbi/`)

Generated by: `scripts/export_powerbi_data.py`

These are **aggregated views** optimized for Power BI dashboards. Row counts are intentionally small for fast visualization.

### funnel_metrics.csv (~8,000 rows)

Funnel conversion rates grouped by source, device, and date.

| Column | Type | Description |
|--------|------|-------------|
| `source` | VARCHAR | Traffic source |
| `device` | VARCHAR | Device type |
| `session_date` | DATE | Date of sessions |
| `total_sessions` | INTEGER | Number of sessions |
| `sessions_with_visit` | INTEGER | Sessions with visit |
| `sessions_with_product_view` | INTEGER | Sessions with product view |
| `sessions_with_add_to_cart` | INTEGER | Sessions with add to cart |
| `sessions_with_checkout` | INTEGER | Sessions with checkout |
| `sessions_with_purchase` | INTEGER | Sessions with purchase |
| `visit_to_product_view_rate` | DOUBLE | Conversion rate (0-1) |
| `product_view_to_cart_rate` | DOUBLE | Conversion rate (0-1) |
| `cart_to_checkout_rate` | DOUBLE | Conversion rate (0-1) |
| `checkout_to_purchase_rate` | DOUBLE | Conversion rate (0-1) |
| `visit_to_purchase_rate` | DOUBLE | Overall conversion (0-1) |

### cohort_retention.csv (~2,000 rows)

Weekly retention rates for cohort analysis.

| Column | Type | Description |
|--------|------|-------------|
| `cohort_week` | DATE | Week of user signup |
| `cohort_index` | INTEGER | Weeks since signup (0 = signup week) |
| `users_active` | INTEGER | Users active in this period |
| `cohort_size` | INTEGER | Total users in cohort |
| `retention_rate` | DOUBLE | Retention rate (0-1) |

### ab_test_summary.csv (3-4 rows)

A/B test variant comparison.

| Column | Type | Description |
|--------|------|-------------|
| `ab_test_id` | VARCHAR | Test identifier |
| `variant` | VARCHAR | Variant name (control/variant) |
| `total_sessions` | INTEGER | Sessions in variant |
| `sessions_with_checkout` | INTEGER | Checkouts |
| `sessions_with_purchase` | INTEGER | Purchases |
| `visit_to_purchase_rate` | DOUBLE | Overall conversion (0-1) |
| `checkout_to_purchase_rate` | DOUBLE | Primary metric (0-1) |
| `visit_to_checkout_rate` | DOUBLE | Checkout rate (0-1) |
| `visit_to_cart_rate` | DOUBLE | Add to cart rate (0-1) |

---

## Regenerating Data

### Using uv

```bash
# Generate raw data
uv run python src/data_generator.py

# Export Power BI data (after tables are materialized)
uv run python scripts/export_powerbi_data.py
```

### Using pip

```bash
# Generate raw data
python src/data_generator.py

# Export Power BI data (after tables are materialized)
python scripts/export_powerbi_data.py
```

---

## Notes

- Raw data is deterministic (uses random seed) — regenerating produces the same output
- Power BI exports are aggregated — use raw tables for detailed analysis
- All timestamps are in UTC

